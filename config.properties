# Archivo de configuracion de la aplicacion Manejador Balances RTBS

# Servidor Weblogic
application.initial_context_factory=weblogic.jndi.WLInitialContextFactory

# IP y Puerto servidor weblogic
application.provider_url=t3://CFGLOBD05:8601

# DATASOURCE 
#application.ciclo.vida.datasource=ribd.desa
application.ciclo.vida.datasource=ribd.QA

# Versión OLD (solo 2 días)
#application.ciclo.vida.select=SELECT SPC.sub_id AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 1, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1 * (1 + TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 2,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 2, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+3) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+2))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE)
# Versión Nueva (2 y 4 días) actual planes
#application.ciclo.vida.select=SELECT SPC.sub_id AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 1, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1 * (1 + TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 2,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 2, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+3) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+2))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE) UNION SELECT SPC.sub_id AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 3, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1 * (1 + TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 4,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 4, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+5) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+4))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE)
##application.ciclo.vida.select=SELECT '584128083324' AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 1, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1 * (1 + TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 2,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 2, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+3) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+2))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE) AND ROWNUM <=10 UNION SELECT '584128083324' AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 3, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1 * (1 + TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 4,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 4, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+5) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+4))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE) AND ROWNUM <=10
# Versión Nueva (4 días)
#application.ciclo.vida.select=SELECT SPC.sub_id AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 3, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1+(PC.charge_balance1*TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 4,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 4, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+5) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+4))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE)
#application.ciclo.vida.select=SELECT '584128083439' AS SUBSCRIBER, CS.COS_NAME, 'Su plan ' || CS.COS_NAME || ' vence el ' || to_char(sysdate + 3, 'dd/mm/yy') || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, (PC.charge_balance1+(PC.charge_balance1*TAX1)) AS rentaBasica, (NVL(TO_CHAR(SPC.next_apply_date,'dd'),SPC.apply_Day) || '/' || TO_CHAR(SYSDATE + 4,'MM/YY')) AS NEXT_APPLY_DATE, SPC.sub_id FROM stg.SUB_PERIODIC_CHG_TODAY  SPC, stg.PERIODIC_CHARGES PC, stg.class_of_service CS WHERE SPC.rc_offer_type = 1 AND PC.versionid = ( select max (versionid) from stg.PERIODIC_CHARGES ) AND PC.apply_day > 0 AND PC.cos_id is not null AND SPC.cos_id = PC.cos_id AND (( SPC.apply_day = to_char(sysdate + 4, 'dd') and SPC.next_apply_date is null and SPC.start_date < trunc(sysdate+5) ) or (trunc(SPC.next_apply_date) = trunc(sysdate+4))) AND (SPC.COS_ID = CS.COS_ID AND CS.VERSIONID = ( select MAX(CS2.VERSIONID) from stg.class_of_service CS2 where CS2.COS_ID = CS.COS_ID ) ) AND SPC.INSERTION_DATE > TRUNC(SYSDATE) AND ROWNUM <= 6
# Versión Planes y Servicios (solo 2 y 4 días)
#application.ciclo.vida.select=SELECT '584128083388' as SUBSCRIBER,COS_NAME, 'Su plan ' || COS_NAME || ' vence el ' ||  to_char( fecha_cobro-1,'dd/mm/yyyy' )|| ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, rentabasica, to_char(fecha_cobro,'dd/mm/yyyy'), subscriber FROM ( SELECT   sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro,   cos_name, charge_balance1*(1+tax1) rentabasica FROM   STG.sub_periodic_chg_today spc   INNER JOIN   STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id   and pc.cos_id = spc.cos_id   INNER JOIN   STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1   and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2))   and nvl(spc.next_apply_date,start_date)< end_date		   and spc.rc_offer_type = 1    and pc.versionid = (select current_versionid from STG.current_service_version)   and cos.versionid = pc.versionid and rownum < 3 ) UNION ALL SELECT '584128083388' as SUBSCRIBER, alcs_name , 'Su servicio ' || alcs_name || ' vence el ' || to_char( fecha_cobro-1,'dd/mm/yyyy' ) || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del servicio' as MENSAJE, rentaBasica, to_char(fecha_cobro,'dd/mm/yyyy'), subscriber FROM ( SELECT   sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro,   alcs_name, charge_balance1*(1+tax1) rentabasica FROM   STG.sub_periodic_chg_today spc   INNER JOIN   STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id   and pc.cos_id = spc.cos_id   and exists(     select distinct(pc3.per_charge_id)     from stg.periodic_charges pc3     where pc3.alcs_id is not null   and pc.per_charge_id = pc3.per_charge_id   )   INNER JOIN   STG.alcs_definition alc   ON spc.alcs_id = alc.alcs_id WHERE 1=1   and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2))   and nvl(spc.next_apply_date,start_date)< end_date   and spc.rc_offer_type != 1    and pc.versionid = (select current_versionid from STG.current_service_version)   and alc.versionid =pc.versionid and rownum < 3 )
#application.ciclo.vida.select=SELECT  '584128083388' as SUBSCRIBER,COS_NAME, 'Su plan ' || COS_NAME || ' vence el ' ||  to_char( fecha_cobro-1,'dd/mm/yyyy' )|| ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del plan' as MENSAJE, rentabasica, to_char(fecha_cobro,'dd/mm/yyyy'), subscriber FROM    (  SELECT   sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro,   cos_name, charge_balance1*(1+tax1) rentabasica FROM   STG.sub_periodic_chg_today spc INNER JOIN   STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id INNER JOIN   STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+5),trunc(sysdate+8)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type = 1    and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid and rownum < 3 and COS_NAME like '%Hogar 412%') UNION ALL SELECT '584128083388' as SUBSCRIBER, alcs_name , 'Su servicio ' || alcs_name || ' vence el ' || to_char( fecha_cobro-1,'dd/mm/yyyy' ) || ' recuerde contar con saldo mayor a Bs.F rentaBasica la noche de ese dia para cubrir la cuota del servicio' as MENSAJE, rentaBasica, to_char(fecha_cobro,'dd/mm/yyyy'), subscriber FROM    (  SELECT   sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica FROM   STG.sub_periodic_chg_today spc INNER JOIN   STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id   and exists(    select distinct(pc3.per_charge_id) from stg.periodic_charges pc3 where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id   ) INNER JOIN   STG.alcs_definition alc   ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date   and spc.rc_offer_type != 1          and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid and rownum < 3  and alcs_name like '%Todos 412%')

#CASO: RUMBA412 por TODOS412
#application.ciclo.vida.select=SELECT '584128083439' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ') || ' el ' || to_char( fecha_cobro,'dd-mm' ) || ' BsFrentaBasica Mantenga saldo la noche anterior y disfrutara bonos por Pago Puntual' as MENSAJE, rentabasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date		 and spc.rc_offer_type = 1 and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid  and cos_name in ('Rumba 412', 'Rumba 412 ZF') AND ROWNUM <= 5) UNION ALL SELECT '584120883439' AS SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro,'dd-mm-yy' ) || ' por BsFrentaBasica Mantenga saldo la noche anterior y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges pc3  where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id ) INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1 and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid and alcs_name in ('Rumba 412', 'Rumba 412 ZF') AND ROWNUM <= 5)

#Version existente hasta el 20 de diciembre de 2011 con BsF
#application.ciclo.vida.select=SELECT '584128083439' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ') || ' el ' || to_char( fecha_cobro,'dd-mm' ) || ' BsFrentaBasica Mantenga saldo la noche anterior y disfrutara bonos por Pago Puntual' as MENSAJE, rentabasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date		 and spc.rc_offer_type = 1 and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid  AND ROWNUM <= 5) UNION ALL SELECT '584120883439' AS SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro,'dd-mm-yy' ) || ' por BsFrentaBasica Mantenga saldo la noche anterior y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges pc3  where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id ) INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1 and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid AND ROWNUM <= 5)

#Version existente a partir del 20 de diciembre de 2011 de Bsf a Bs

#application.ciclo.vida.select=SELECT '584128083582' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ')  || ' el ' || to_char( fecha_cobro,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE, 55 rentabasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM (  SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+2),trunc(sysdate+0)) and nvl(spc.next_apply_date,start_date)< end_date and cos_name = 'Super Pegado 100' and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid AND ROWNUM <= 10 ) 
#prueba


##################################################################
#############  Prueba aumento de tarifas Mayo 2015  ##############
##################################################################

#application.ciclo.vida.select=SELECT SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ') || ' ' || to_char( fecha_cobro-1,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE,rentabasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.PERIODIC_CHARGES_ADJ_20150501 pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type = 1 and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid  ) UNION ALL SELECT SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro-1,'dd-mm-yy' ) || ' por Bs.rentaBasica Mantenga saldo esa noche  y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.PERIODIC_CHARGES_ADJ_20150501 pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges_extra pc3 where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id ) INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1 and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid)
application.ciclo.vida.select=(SELECT '584128083439' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ')  || ' ' || to_char( fecha_cobro-1,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE, rentabasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica      FROM STG.sub_periodic_chg_today spc      INNER JOIN stg.periodic_charges_adj_20150501 pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id      INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id      WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) = (trunc(sysdate+4)) and nvl(spc.next_apply_date,start_date)< end_date      and spc.rc_offer_type = 1 and pc.versionid =(select current_versionid from STG.current_service_version)      and cos.versionid = pc.versionid  ) WHERE fecha_cobro >= '07-Jul-2015' AND ROWNUM<=10 ) UNION ALL (SELECT '584128083439' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ')  || ' ' || to_char( fecha_cobro-1,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE, rentabasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica      FROM STG.sub_periodic_chg_today spc      INNER JOIN stg.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id      INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id      WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) = (trunc(sysdate+4)) and nvl(spc.next_apply_date,start_date)< end_date      and spc.rc_offer_type = 1 and pc.versionid =(select current_versionid from STG.current_service_version)      and cos.versionid = pc.versionid  ) WHERE fecha_cobro < '07-Jul-2015' AND ROWNUM<=10 ) UNION ALL (SELECT '584128083439' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ')  || ' ' || to_char( fecha_cobro-1,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE, rentabasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica      FROM STG.sub_periodic_chg_today spc      INNER JOIN stg.periodic_charges_adj_20150501 pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id      INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id      WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) = (trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date      and spc.rc_offer_type = 1 and pc.versionid =(select current_versionid from STG.current_service_version)      and cos.versionid = pc.versionid  ) WHERE fecha_cobro >= '07-Jul-2015' AND ROWNUM<=10 ) UNION ALL (SELECT '584128083439' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ')  || ' ' || to_char( fecha_cobro-1,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE, rentabasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica      FROM STG.sub_periodic_chg_today spc      INNER JOIN stg.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id      INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id      WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) = (trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date      and spc.rc_offer_type = 1 and pc.versionid =(select current_versionid from STG.current_service_version)      and cos.versionid = pc.versionid  ) WHERE fecha_cobro < '07-Jul-2015' AND ROWNUM<=10 ) UNION all (SELECT SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro-1,'dd-mm-yy' ) || ' por Bs.rentaBasica Mantenga saldo esa noche  y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber,  nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica  FROM STG.sub_periodic_chg_today spc  INNER JOIN STG.periodic_charges_adj_20150501 pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and  exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges_extra pc3  where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id )  INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date)  in (trunc(sysdate+4)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1  and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid )  where fecha_cobro >= '07-Jul-2015' AND ROWNUM<=10 )  UNION all (SELECT SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro-1,'dd-mm-yy' ) || ' por Bs.rentaBasica Mantenga saldo esa noche  y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber,  nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica  FROM STG.sub_periodic_chg_today spc  INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and  exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges_extra pc3  where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id )  INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date)  in (trunc(sysdate+4)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1  and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid )  where fecha_cobro < '07-Jul-2015' AND ROWNUM<=10 )  UNION all (SELECT SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro-1,'dd-mm-yy' ) || ' por Bs.rentaBasica Mantenga saldo esa noche  y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber,  nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica  FROM STG.sub_periodic_chg_today spc  INNER JOIN STG.periodic_charges_adj_20150501 pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and  exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges_extra pc3  where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id )  INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date)  in (trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1  and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid )  where fecha_cobro >= '07-Jul-2015' AND ROWNUM<=10 )  UNION all (SELECT SUBSCRIBER, alcs_name, 'Fecha Unica de Pago ' || to_char( fecha_cobro-1,'dd' ) || ' de cada mes.Prox renov serv ' || DECODE((SUBSTR(alcs_name,length(alcs_name)-2,length(alcs_name))), ' ZF', (SUBSTR(alcs_name,0,(length(alcs_name)-2))), alcs_name) || ' el ' || to_char( fecha_cobro-1,'dd-mm-yy' ) || ' por Bs.rentaBasica Mantenga saldo esa noche  y disfrute sus beneficios' as MENSAJE, rentaBasica, to_char(fecha_cobro-1,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, alcs_name, charge_balance1*(1+tax1) rentabasica  FROM STG.sub_periodic_chg_today spc  INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id and  exists(  select distinct(pc3.per_charge_id)  from stg.periodic_charges_extra pc3  where pc3.alcs_id is not null and pc.per_charge_id = pc3.per_charge_id )  INNER JOIN STG.alcs_definition alc ON spc.alcs_id = alc.alcs_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date)  in (trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type != 1  and pc.versionid = (select current_versionid from STG.current_service_version) and alc.versionid =pc.versionid )  where fecha_cobro < '07-Jul-2015' AND ROWNUM<=10 )


#application.ciclo.vida.select=SELECT '584128083582' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ')  || ' el ' || to_char( fecha_cobro,'dd-mm' ) || ' Bs.rentaBasica Mantenga saldo esa noche  y disfrutara bonos por Pago Puntual' as MENSAJE, 55 rentabasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM (  SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id and pc.cos_id = spc.cos_id INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1 and nvl(spc.next_apply_date,spc.start_date) > sysdate - 365and nvl(spc.next_apply_date,start_date)< end_date and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid AND ROWNUM <= 10 )
#application.ciclo.vida.select=SELECT '584128083388' AS SUBSCRIBER, COS_NAME, 'Fecha Unica de Pago ' || to_char( fecha_cobro,'dd' ) || ' de cada mes. Prox renov plan ' || REPLACE(DECODE((SUBSTR(COS_NAME,length(COS_NAME)-2,length(COS_NAME))), ' ZF', (SUBSTR(COS_NAME,0,(length(COS_NAME)-2))), COS_NAME),' ') || ' el ' || to_char( fecha_cobro,'dd-mm' ) || ' BsFrentaBasica Mantenga saldo la noche anterior y disfrutara bonos por Pago Puntual' as MENSAJE,rentabasica, to_char(fecha_cobro,'dd/mm/yyyy') AS next_apply_date, subscriber FROM ( SELECT sub_id subscriber, nvl(spc.next_apply_date,spc.start_date) fecha_cobro, cos_name, charge_balance1*(1+tax1) rentabasica         FROM STG.sub_periodic_chg_today spc INNER JOIN STG.periodic_charges pc ON pc.per_charge_id = spc.per_charge_id         and pc.cos_id = spc.cos_id INNER JOIN STG.class_of_service cos ON spc.cos_id = cos.cos_id WHERE 1=1         and nvl(spc.next_apply_date,spc.start_date) in (trunc(sysdate+4),trunc(sysdate+2)) and nvl(spc.next_apply_date,start_date)< end_date and spc.rc_offer_type = 1 and pc.versionid = (select current_versionid from STG.current_service_version) and cos.versionid = pc.versionid and sub_id in (584121026227,584122992007,584121037433,584122992403,584125308943,584125307287,584125308403,584125307063,584121215820,584121119373,584127966873,584125307297,584129108733,584120712517,584127459487,584127944143,584129292673))

#La lista negra incluye Planes y Servicios
application.ciclo.vida.planRestringido=Radicall Plus ZF;Nexo 2;Nexo 2 ZF;Microempresa Control;Microempresa Control ZF;Plus Control;Super Control;Plus Control ZF;Super Control ZF;BAM 3G Mega;BAM 3G Mega ZF;BAM 3G Super;BAM 3G Super ZF;BAM 3G 1GB;BAM 3G 1GB ZF;Rumba Movil;Rumba Movil ZF;BAM 3G Experto;BAM 3G Avanzado;BAM 3G Eventual;BAM 3G Frecuente;BAM 3G Frecuente ZF;BAM 3G Experto ZF;BAM 3G Eventual ZF;BAM 3G Avanzado ZF;BAM 3G 10GB;BAM 3G 10GB ZF;BAM 3G Mega;BAM 3G Mega ZF;BAM 3G Moderado;BAM 3G Moderado ZF;Asistente Hogar 412; Asistente Hogar 412 ZF

#application.url.sms.sender=http://10.27.31.184:7025/SMS/SMSSenderServlet
#application.url.sms.sender=http://10.27.31.224:7011/SMS/SMSSenderServlet
application.url.sms.sender=http://CFGLOBD05:9101/SMS/SMSSenderServlet

#application.user.sms.sender=recarga
application.user.sms.sender=test

#application.password.sms.sender=4cge8z2s
application.password.sms.sender=t3sprsms

#application.system.sms.sender=Digitel
application.system.sms.sender=TEST

#application.channel.sms.sender=Digitel
application.channel.sms.sender=TEST

#application.sender.sms.sender=recarga
application.sender.sms.sender=TEST

application.httpclient.maxconnetionPerHost=25

application.httpclient.maxTotalConnections=25

application.ciclo.vida.mailHost=CBN-MSS-SRV-040.digitelcorp.com.ve
application.ciclo.vida.to=aplicaciones_integracion_oss@digitel.com.ve;carlos_perdigon@digitel.com.ve;milexis_rodriguez@digitel.com.ve
application.ciclo.vida.from=MDW_INT_CSATC02_7007@digitel.com.ve
application.ciclo.vida.subject=(CV) - Ciclo de Vida
application.ciclo.vida.bodyIni=
application.ciclo.vida.bodyFin=Fin del proceso de notificación de cobro de renta basica a clientes prepago
